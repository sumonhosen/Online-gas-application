/*(c) 2014, Furina Admin. JS Files (Compressed) 2015-06-25 */!function(){Z={register:function(a,b){this[a]=b}}}();var editedArray=[],selectedRows=[];!function(){function a(a){var b=$("div.grid").data("dataView"),c=b.getItems();if(!a||void 0==a.parent||"number"!=typeof a.parent)return a;for(var d=c[a.parent]||!1,e=!0;d;){if("boolean"==typeof d._collapsed&&1==d._collapsed){e=!1;break}d=c[d.parent]||!1}return e?a:void 0}function b(b,e,f,g,h){if($(".slickgridView").hasClass("comfortable")?c.rowHeight=35:$(".slickgridView").hasClass("cozy")?c.rowHeight=30:$(".slickgridView").hasClass("compact")&&(c.rowHeight=24),void 0!=g.editable?c.editable=!0:c.editable=!1,$.extend(g,g,c),g.dataItemColumnValueExtractor=function(a,b){return a[b.model][b.field]},1==$("#IS_MOBILE_BROWSER").val())for(var i in e)void 0==e[i].minWidth&&(void 0!=e[i].width?e[i].minWidth=e[i].width:e[i].minWidth=100);else if(desktopView)for(var i in e)void 0==e[i].minWidth&&(void 0!=e[i].width?e[i].minWidth=e[i].width:e[i].minWidth=100);for(var i in e)$.extend(e[i],e[i],d);var j=g.isTreeView?g.isTreeView:!1;dataView=new Slick.Data.DataView({inlineFilters:!0});var k=new Slick.Grid(b,dataView,e,g);b.data("grid",k),b.data("dataView",dataView),k.heightfix=function(){Z.autoHeight(b,".container",window),k.resizeCanvas()},$(window).resize(k.heightfix),k.heightfix(),k.setSelectionModel(new Slick.RowSelectionModel);{var l={pagerType:"select",pageSize:[50,100,200,500,1e3,1e4,2e4],defaultPagesize:100,buttons:!0},h=new Slick.Controls.Pager(dataView,k,h,l),m=new Slick.Controls.ColumnPicker(e,k,g);new Slick.Controls.SummaryFooter(dataView,k,$("#footer"))}$(".pagerTypeSelect option[ value="+l.defaultPagesize+"]").attr("selected","selected"),k.onCellChange.subscribe(function(a,b){for(var c in b.item.row)b.item.row.hasOwnProperty(c)&&void 0!=b.item[c]&&(b.item.row[c]=b.item[c]);if(b.item.links.action="<a title='This row is edited' class='action-type-edit ajax-content-loader' style='color:blue'><i class='fa fa-pencil-square-o'></i></a>",dataView.updateItem(b.item.id,b.item),selectedRows.push(b.row),editedArray.length>0){for(var d=1,e=0;editedArray.length>e;e++)if(b.item.row.id===editedArray[e].id){d=0,editedArray[e]=b.item.row;break}d&&editedArray.push(b.item.row)}else editedArray.push(b.item.row);k.setSelectedRows(selectedRows)}),k.onKeyDown.subscribe(function(a,b){if(13===a.keyCode){var c=k.getActiveCell().row,d=k.getActiveCell().cell,e=k.getColumns().length-1;$.each(k.getColumns(),function(b,f){k.getDataItem(c);return b>d&&f.editor?(k.gotoCell(c,b,!0),a.stopImmediatePropagation(),!1):void(b==e&&(c==k.getDataLength()-1?c=0:c+=1,$.each(k.getColumns(),function(b,d){k.getDataItem(c);return d.editor?(k.gotoCell(c,b,!0),a.stopImmediatePropagation(),!1):void 0})))})}}),k.onActiveCellChanged.subscribe(function(a){}),k.onValidationError.subscribe(function(a,b){alert(b.validationResults.msg)}),k.onSort.subscribe(function(a,b){sortdir=b.sortAsc?"asc":"desc",sortcol=b.sortCol.field,dataView.sortColumn({field:sortcol,order:sortdir})}),dataView.onRowCountChanged.subscribe(function(a,b){k.updateRowCount(),k.render()}),dataView.onRowsChanged.subscribe(function(a,b){k.invalidateRows(b.rows),k.render()}),j&&dataView.setFilter(a),j&&k.onClick.subscribe(function(a,b){if($(a.target).hasClass("toggle")||$(a.target).hasClass("toggle-title")){var c=dataView.getItem(b.row);c&&(c._collapsed?c._collapsed=!1:c._collapsed=!0,dataView.updateItem(c.id,c)),a.stopImmediatePropagation()}}),dataView.onPagingInfoChanged.subscribe(function(a,b){var c=b.pageNum==b.totalPages-1,d=c||10==b.pageSize,e=k.getOptions();e.enableAddRow!=d&&k.setOptions({enableAddRow:d})}),dataView.getData(f,k),b.prev(".pager-container").on("click",".gridSettingsOption li",function(a){var b=window.location.href;b=b.split(".php");var c=b.shift();c+=".php",b=b.join();var d=$(this).attr("value");a.preventDefault();var e=$("input[name=selectedView]:checked",".gridSettings").val();if(void 0!=e){var f=["id","hide","width","order"];if(0==d){return void(window.confirm("Confirm Restore Grid Settings")&&window.location.reload())}else if(1==d){if(window.confirm("Over write existing grid settings")){var g={},h=k.getColumns();if(h.length)for(var i in h)g[h[i].id]=h[i];for(var j=m.getAllColumns(),l=0;l<j.length;l++){j[l].order=l+1;for(var i in j[l])j[l].hasOwnProperty(i)&&-1!==f.indexOf(i)?void 0!=g[j[l].id]&&(j[l][i]=g[j[l].id][i]||j[l][i]):j[l][i]=void 0}$.ajax({url:c+"/titas/Grids/Save?url="+encodeURIComponent(b)+"&platform="+e,data:{columns:j},type:"post"}).done(function(){$(this).addClass("done")})}}else 2==d&&window.confirm("Confirm delete grid settings")&&$.ajax({url:c+"/titas/Grids/DeleteSettings",data:{url:b,platform:e},type:"get",dataType:"json",success:function(a){window.location.reload()}})}})}var c={editable:!1,enableAddRow:!1,enableCellNavigation:!0,asyncEditorLoading:!1,forceFitColumns:!0,topPanelHeight:25,rowHeight:25,enableTextSelectionOnCells:!0},d={};b.formatter={number:function(a,b,c,d,e){return parseFloat(c).toFixed(d.filter.decimal_points)},action:function(a,b,c,d,e){return c},treeView:function(a,b,c,d,e){var f=$("div.grid").data("dataView"),g=f.getItems();c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var h="<span style='display:inline-block;height:1px;width:"+15*e.indent+"px'></span>",i=f.getIdxById(e.id);return g[i+1]&&g[i+1].indent>g[i].indent?e._collapsed?h+" <span class='toggle expand'></span>&nbsp;"+c:h+" <span class='toggle collapse'></span>&nbsp;"+c:h+" <span class='toggle'></span>&nbsp;"+c},costFormatter:function(a,b){return"BDT "+parseFloat(a).toFixed(2)},intFormatter:function(a){return parseInt(a)}},b.destroy=function(a){var b=a.data("grid");void 0!=b&&($(window).unbind("resize",b.heightfix),b.destroy())},b.refresh=function(a){var b=a.data("dataView");void 0!=b&&b.getData()},Z.register("grid",b)}(),function(){Z.autoHeight=function(a,b,c){var d=a,e=$(b),f=parseInt($(c).height())-Math.ceil(e.outerHeight()+e.position().top);f=parseInt(f);var g=d.outerHeight()+f-50,h=parseInt(d.css("min-height"));g>h&&d.css({height:g})}}(),function(){Z.input={attachAll:function(){$(".datetime, .date.time").each(function(){var a=this;$(a).attr("autocomplete","off").datetimeEntry({datetimeFormat:"Y-O-D H:M",beforeShow:function(a){var b=$.trim($(a).val());if(16!=b.length){var c=(new Date).getFullYear(),d=(new Date).getMonth()+1,e=(new Date).getDate();d=1==d.length?"0"+d:d,e=1==e.length?"0"+e:e,$(a).val(c+"-"+d+"-"+e+" 00:00")}},afterShow:function(){var b=$(a).datetimeEntry("getCurrentDateTime").val(),c=$(a).data("oldValue");$(a).data("oldValue",b);var d=b.split(" "),e=d[0].split("-");if(!c||c!==b){var f=d[1].split(":");3==e.length&&$(a).datepick("setDate",new Date(e[0],e[1]-1,e[2],f[0]||0,f[1]||0,f[2]||0))}}}).datepick({dateFormat:"yyyy-mm-dd",showTime:!0})}),$(".date").each(function(){var a=this;$(a).parent("div.input.ic").addClass("date"),$(a).attr("autocomplete","off").datetimeEntry({datetimeFormat:"Y-O-D",beforeShow:function(a){var b=$.trim($(a).val());if(10!=b.length){var c=(new Date).getFullYear(),d=(new Date).getMonth()+1,e=(new Date).getDate();d=1==d.length?"0"+d:d,e=1==e.length?"0"+e:e,$(a).val(c+"-"+d+"-"+e)}},afterShow:function(){var b=$(a).datetimeEntry("getCurrentDateTime").val(),c=$(a).data("oldValue");$(a).data("oldValue",b);var d=b.split(" "),e=d[0].split("-");c&&c===b||3==e.length&&$(a).datepick("setDate",new Date(e[0],e[1]-1,e[2]))}}).datepick({dateFormat:"yyyy-mm-dd",showOnFocus:!0})}),$(".time").attr("autocomplete","off").datetimeEntry({datetimeFormat:"H:M"})}}}(),function(){var a=window.History,b=window.document;Z.ajaxify={isEnabled:function(){return a.enabled},attach:function(a){var b=$(a).attr("href"),c=$(a).attr("title")||null;Z.ajaxify.go(b,c)},go:function(b,c){a.enabled||(location.href=b),a.pushState(null,c,b)},init:function(){if(a.enabled){var c=0;$(window).bind("statechange",function(){if(c4s.isIE()){if(0!=c)return void setTimeout(function(){c=0},2e3);c++}var d=a.getState(),e=d.url,f=$("#page-content"),g=("-"+(f.outerHeight()+200)+"px",url_build(e,{html:"1"}));$.ajax({method:"GET",url:g,headers:{"X-Requested-Layout":"ajax"},success:function(a,c,g){var h,i=a;return(h=i)?(f.stop(!0,!0),f.html(h),$(".main-menu").find("li a.single-menu").removeClass("active"),$(".main-menu").find("li a.single-menu").removeClass("current"),$(".main-menu").find("ul.second-menu li a").removeClass("current"),$(".main-menu li a").each(function(){$(this).attr("href")==d.hash&&($(this).hasClass("single-menu")?$(this).addClass("active"):$(this).parent().parent().parent().parent("ul").hasClass("second-menu")?$(this).parent().parent().parent().parent().parent("li").find("a.single-menu").addClass("active"):$(this).parent().parent().parent().find("a.single-menu").addClass("active"))}),void(0!=$(".login-container").length&&window.location.reload())):(b.location.href=e,!1)},error:function(a,c,d){return b.location.href=e,!1}})})}}}}(),function(){Z.menu={init:function(){$(".main-menu").smartmenus({mainMenuSubOffsetX:10,mainMenuSubOffsetY:0,subMenusSubOffsetX:10,subMenusSubOffsetY:0,showDuration:100,hideOnClick:!0,showOnClick:!0,subIndicatorsText:'<i class="fa fa-angle-right fa-2x"></i>',subMenusMaxWidth:"14em",keepHighlighted:!0}),$(".main-menu").smartmenus("keyboardSetHotkey","123","shiftKey"),$(".main-menu").find("ul.second-menu li a").removeClass("current"),$(".main-menu li a.single-menu").each(function(){$(this).hasClass("current")&&$(".main-menu li a.single-menu").removeClass("active")})},toggleButton:function(){$(".toggle-panel").click(function(){$("body").hasClass("hide_menu")?$("body").removeClass("hide_menu"):$("body").addClass("hide_menu")})},overlayMode:function(){$(".content-wrapper").click(function(){$("body").hasClass("hide_menu")?$("body").removeClass("hide_menu"):$("body").addClass("hide_menu")})},ajaxify:function(){Z.ajaxify.isEnabled()&&$(".main-menu").bind("click.smapi",function(a,b){if(void 0===b&&a.preventDefault(),0!=$(".fa-sign-out",$(b)).length)return void(window.location.href=$(b).attr("href"));if(!$(b).hasClass("has-submenu")){var c=$(b).attr("href"),d=$(b).attr("title")||null;if(c==window.location.pathname){var e=$("#page-content"),f=url_build(c,{html:"1"});$.ajax({method:"GET",url:f,headers:{"X-Requested-Layout":"ajax"},success:function(a,b,c){return e.stop(!0,!0),e.html(a),e.hide(),0!=$(".login").length?void window.location.reload():void e.show()},error:function(a,b,c){window.location.reload()}})}else Z.ajaxify.go(c,d),a.preventDefault()}})}}}(),function(){Z.processStep={init:function(){$("a.state-chage-trigger").click(function(a){a.preventDefault();var b=$(this);if(!b.parent("li.step-state").hasClass("disabled-state")){var c=b.attr("href"),d={};d[$("#Process_batchname").attr("name")]=$("#Process_batchname").val(),d[$("#Process_type").attr("name")]=$("#Process_type").val(),d[$("#Process_datestamp").attr("name")]=$("#Process_datestamp").val(),d[$("#Process_state").attr("name")]=$("#Process_state").val(),d.html=1;var e=$("#page-content"),f=url_build(c,d);$.ajax({method:"GET",url:f,headers:{"X-Requested-Layout":"ajax"},success:function(a,b,c){return e.stop(!0,!0),e.html(a),e.hide(),0!=$(".login").length?void window.location.reload():void e.show()},error:function(a,b,c){}})}})}}}(),function(){Z.ajaxForm={init:function(){$("form[ajaxForm='pending']").each(function(){var a=$(this),b=a.attr("id");""==$.trim(b)&&(b="formId"+(new Date).getTime()+parseInt(1e5*Math.random()),a.attr("id",b)),a.attr("ajaxForm","loaded");var c=window.location.href;c=c.split(".php"),c=c[0].split("/"),c.pop(),c=c.join("/");var d={beforeSerialize:function(){$("#"+b).oLoader({backgroundColor:"#888",image:c+"/public/static/images/loader1.gif",fadeInTime:500,fadeOutTime:1e3,fadeLevel:.5})},beforeSubmit:function(){$(".formErrorMassage",a).remove()},success:function(a,c,d,e){if(a){var f=a.error||!1;if(f)for(var g in f)if(f.hasOwnProperty(g))for(var h in f[g])if(f[g].hasOwnProperty(h)){var i=g+"_"+h;$("#"+i,e).after("<label class='error formErrorMassage' for='"+i+"'>"+f[g][h]+"</label>")}}$("#"+b).oLoader("hide")},error:function(a,c,d){$("#"+b).oLoader("hide"),"Not Found"==c.statusText||"timeout"==c.statusText||"error"==c.statusText}};$(this).ajaxForm(d)})}}}(),function(){Z.tabs={init:function(){$("ul.tab").each(function(){var a=$(this).attr("targetpanes");if(a){$.tools.tabs.addEffect("customAjax",function(a,b){this.getTabs().eq(a).data("ajax")?this.getPanes().eq(a).load(this.getTabs().eq(a).attr("url"),b):b.call(),this.getPanes().hide().eq(a).show()});{$(this).tabs(a,{current:"active",effect:"customAjax"})}$(this).removeAttr("targetpanes")}})}}}(),function(){c4s={},c4s.components={selectize:function(){$("select:not(.operator)").each(function(){var a=$(this),b=a.data("url")||"",c=a.data("limit")||500,d=a.data("search_field"),e=a.data("value_field"),f=a.data("label_field"),g=a.data("query_parameters")||{};if(b){var h=null,i=null;a.selectize({preload:"focus",valueField:e,labelField:f,searchField:d,maxOptions:c,options:[],create:!1,render:{option:function(a,b){return'<div><span class="name">'+b(a[f])+"</span></div>"}},onFocus:function(){var c=a.data("url")||"",d=a.data("query_parameters")||{};(c!=b||JSON.stringify(d)!=JSON.stringify(g))&&this.clearOptions()},load:function(e,f){var j=a.data("url")||"",k=a.data("query_parameters")||{};c=a.data("limit")||500;var l="search["+d.split(".").join("][")+"]",m=$.extend({pageSize:c},k);if(m[l]=e,j==b&&JSON.stringify(k)==JSON.stringify(g)){if(h==e)return;if(null!==h&&e.substr(0,h.length)==h&&null!==i&&c>i)return}else b=j,g=k;$.ajax({url:b,type:"GET",dataType:"json",data:m,error:function(){f()},success:function(a){var b,c=[];for(var d in a.rows){b={};for(var g in a.rows[d])for(var j in a.rows[d][g])b[g+"."+j]=a.rows[d][g][j];c.push(b)}h=e,i=a.totalRows,f(c)}})}})}else $(this).selectize({})})},grid:function(dataSchema,dataSrc){var current_url=window.location.href;current_url=current_url.split(".php");var current_url_prefix=current_url.shift();current_url_prefix+=".php",current_url=current_url.join(),$("div.gridview").each(function(){var $this=$(this),$grid=$(".grid",$this),$pager=$(".pager",$this),options=$grid.data("options"),src=$grid.data("src"),schema=$grid.data("schema");dataSrc&&(src=dataSrc),dataSchema&&(schema=dataSchema),src||(src=location.href),$.getJSON(schema,function(data){for(var columns=data.columns,columns_to_remove=[],c=0;c<columns.length;c++)if(void 0!==columns[c].editor&&(columns[c].editor=eval(columns[c].editor)),0==columns[c].disp||"false"==columns[c].disp)columns_to_remove.push(c);else{if(void 0!==columns[c].filter){var splitted=columns[c].filter.formatter.split("."),fun=window;for(var s in splitted)fun=fun[splitted[s]];columns[c].formatter=fun}if(void 0!==columns[c].summaryFormatter){var splitted=columns[c].summaryFormatter.summaryFormatter.split("."),fun=window;for(var s in splitted)fun=fun[splitted[s]];columns[c].summaryFormatter=fun}void 0==columns[c].order&&(columns[c].order=1e3+c)}for(var c=columns_to_remove.length-1;c>=0;c--)columns.splice(columns_to_remove[c],1);columns.sort(function(a,b){return a.order-b.order}),options||(options={}),Z.grid($grid,columns,src,options,$pager)})})},searchPanel:{inputPadding:function(){$(".search .ic").each(function(){var a=$(this),b=function(){var b=$(this),c=$("label",a).outerWidth(),d=parseInt(b.css("min-width"))+c+8,e=parseInt(a.css("max-width"));d>e&&a.css({"max-width":d}),b.css({"padding-left":c+4})};a.children().filter("input,select,textarea").each(b),a.find("div.selectize-input").each(b),a.hasClass("compound")?$("input, select, textarea",$(this)).focusin(function(){a.addClass("focus")}).focusout(function(){a.removeClass("focus")}):$("label",a).each(function(){var a=$(this).parent();$(this).detach().appendTo(a)})})},ajaxLoad:function(){$("section.grid .search form").submit(function(a,b){var c=$("section.grid div.grid").data("grid"),d=$(this).ajaxUrl();return c.getData().getData(d),!1})},refresh:function(){var a=$("section.grid div.grid").data("grid"),b=$(this).ajaxUrl();return a.getData().getData(b),!1}},inputEnterKeyDown:function(){$("div.ic.input input").keydown(function(a){if(!$(this).parent("div").parent("div").hasClass("search")&&($(this).attr("autocomplete","off"),13==a.which)){var b=$("input[type=text]").index(this)+1,c=$("section:not(.grid)").find("input[type=text]").length;a.preventDefault(),a.which=9,a.keyCode=9,c==b?$("input[type=text]:eq(0)").parent("div").parent("div").hasClass("search")?$("input[type=text]:eq(1)").focus():$("input[type=text]:eq(0)").focus():$("input[type=text]:eq("+b+")").focus()}})}},c4s.fillScreen=function(){},c4s.attachAll=function(){Z.input.attachAll(),Z.tabs.init(),Z.processStep.init(),Z.ajaxForm.init()},c4s.headerInfoPanel=function(a,b,c){var d="auto";if(c){if($(window).width()>565)return b.stopPropagation(),!1;d="auto"}return $("ul.icon-label-details").hide(),a.toggle().css("left",d),b.stopPropagation(),!1},c4s.setHeaderInfoPanel=function(){$(".icon-wrapper-inner").on("click","a.icon-label",function(a){c4s.headerInfoPanel($(this).next("ul.icon-label-details"),a,!1)}),$(".icon-wrapper-inner").on("click","a.icon-balance",function(a){c4s.headerInfoPanel($("ul.icon-balance-details:first"),a,!0)}),$(".icon-wrapper-inner").on("click","a.icon-label-close",function(){$(this).closest("ul.icon-label-details").hide()})},c4s.bindAlertBoxEvent=function(){$("#page-content-wrapper").on("click",".alert-box .close",function(){$(this).parent(".alert-box").remove()})},c4s.configureScotchPanel=function(){var a=null;a=$("#scotch-panel").scotchPanel({containerSelector:"div.container",direction:"left",duration:200,transition:"ease",clickSelector:".toggle-panel",distanceX:"15em",enableEscapeKey:!0,startOpened:0==$("#IS_MOBILE_BROWSER").length?!0:!1,pageContentWrapper:$("#page-content-wrapper"),beforePanelOpen:function(){$("nav").children("div.fixed").show()},afterPanelOpen:function(){},beforePanelClose:function(){$("nav").children("div.fixed").hide()},afterPanelClose:function(){}}),$("#IS_MOBILE_BROWSER").length},c4s.isIE=function(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1]):!1},c4s.init=function(){c4s.fillScreen(),c4s.components.grid(),c4s.components.selectize(),c4s.components.searchPanel.inputPadding(),c4s.components.searchPanel.ajaxLoad(),c4s.attachAll(),c4s.setHeaderInfoPanel(),c4s.bindAlertBoxEvent(),c4s.components.inputEnterKeyDown()},c4s.init_once=function(){c4s.init(),Z.menu.init(),Z.ajaxify.init(),Z.menu.ajaxify(),c4s.configureScotchPanel()}}();